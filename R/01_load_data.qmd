---
title: "01_load_data"
format: 
  html:
    embed-resources: true
editor: visual
---

# Create local directories

```{r}
# create local "_raw" and "data" directories if none exist.
dir.create(file.path("..", "_raw"),  recursive = TRUE, showWarnings = FALSE)
dir.create(file.path("..", "data"),  recursive = TRUE, showWarnings = FALSE)

```

# Download dataset

```{r}
input_url <- "https://ftp.ncbi.nlm.nih.gov/geo/datasets/GDS4nnn/GDS4337/soft/GDS4337_full.soft.gz"
output_file <- "../_raw/full_dataset.soft.gz"
curl::curl_download(url = input_url, destfile = output_file)
```

# Convert to table

```{r}
library("BiocGenerics")
library("Biobase")
library("GEOquery")
GEO_data <- getGEO(filename="../_raw/full_dataset.soft.gz")
data_table <- Table(GEO_data)
```

# Save object table to /data

```{r}
write.csv(data_table, file="../data/01_data_table_load.csv")
disease_state_vector <- Columns(GEO_data)$disease.state
write.csv(disease_state_vector, file="../data/01_disease_state_vector_load.csv")
```
