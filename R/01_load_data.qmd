---
title: "01_load_data"
format: html
editor: visual
output-file: results/01_load_data.html
---

# Create local directories

```{r}

dir.create(file.path("..", "_raw"), recursive = TRUE)
dir.create(file.path("..", "data"), recursive = TRUE)
```

# Download dataset

```{r}
input_url <- "https://ftp.ncbi.nlm.nih.gov/geo/datasets/GDS4nnn/GDS4337/soft/GDS4337_full.soft.gz"
output_file <- "../_raw/full_dataset.soft.gz"
curl::curl_download(url = input_url, destfile = output_file)
```

# Convert to table

```{r}
library("Biobase")
library("GEOquery")
GEO_data <- getGEO(filename="../_raw/full_dataset.soft.gz")
data_table <- Table(GEO_data)
```

# Save object table to /data

```{r}
write.csv(data_table, file="../data/01_data_table_load.csv")

disease_state_vector <- Columns(GEO_data)$disease.state
Label_vector <- Columns(GEO_data)$sample

disease_df <- tibble(
  disease.state = disease_state_vector,
  Sample = Label_vector
)

write.csv(disease_df, file="../data/01_disease_state_vector_load.csv")
```
