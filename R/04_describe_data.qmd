---
title: "04_describe_data"
format:
  html:
    embed-resources: true
knitr:
  opts_chunk:
    dev: "svg"
    fig.path: "../results/"
editor: visual
---

# Load libraries

```{r}
#| message: false
library("tidyverse")

```

# Describe data

In this document, we will make some descriptive statistics of the two data sets.

-   Rows = genes

-   Cols = samples + metadata

## Load data

```{r}
T2D_data <- read.csv("../data/03_T2D_data.csv")
none_T2D_data <- read.csv("../data/03_none_T2D_data.csv")

# Overview
head(T2D_data)
head(none_T2D_data)

```

## Number of genes

```{r}
genes_T2D <- nrow(T2D_data)
genes_none_T2D <- nrow(none_T2D_data)

genes_T2D
genes_none_T2D

```

## Samples

Counting the sample size for each group (diabetic and none-diabetic) based on the column names starting with "GSM".

```{r}
samples_count_T2D <- T2D_data |>
  select(starts_with("GSM")) |>
  ncol()

samples_count_none_T2D <- none_T2D_data |>
  select(starts_with("GSM")) |>
  ncol()

samples_count_T2D
samples_count_none_T2D

```

There are in total 14650 genes in both data sets.

There are 9 samples in the diabetic data set (T2D).

There are 54 in the control data set (none-diabetic).

## Statistics

The basic statistics for group is calculated separately and displayed in a tibble.

The diabetic data set (T2D):

```{r}
samples_T2D <- T2D_data |>
  select(starts_with("GSM"))

# Calculations
gene_means_T2D <- rowMeans(samples_T2D, na.rm = TRUE)
gene_medians_T2D <- apply(samples_T2D, 1, median, na.rm = TRUE)
gene_sd_T2D <- apply(samples_T2D, 1, sd, na.rm = TRUE)

```

The mean, median, and standard deviation for each gene are displayed below:

```{r}
stats_T2D <- tibble(
  gene = T2D_data$IDENTIFIER,
  mean = gene_means_T2D,
  median = gene_medians_T2D,
  sd = gene_sd_T2D
)

# Display statistics 
stats_T2D

```

The control data set (none-diabetic):

```{r}
samples_none_T2D <- none_T2D_data |>
  select(starts_with("GSM"))

# Calculations
gene_means_none_T2D <- rowMeans(samples_none_T2D, na.rm = TRUE)
gene_medians_none_T2D <- apply(samples_none_T2D, 1, median, na.rm = TRUE)
gene_sd_none_T2D <- apply(samples_none_T2D, 1, sd, na.rm = TRUE)

```

The mean, median, and standard deviation for each gene are displayed below:

```{r}
stats_none_T2D <- tibble(
  gene = none_T2D_data$IDENTIFIER,
  mean = gene_means_none_T2D,
  median = gene_medians_none_T2D,
  sd = gene_sd_none_T2D
)

# Display statistics
stats_none_T2D

```

## Visualization of the mean gene expression (histograms)

Diabetic (T2D):

```{r}
ggplot() +
  geom_histogram(aes(x = gene_means_T2D),
                 bins = 50,
                 fill = "red",
                 color = "black") +
  theme_minimal() +
  labs(title = "Histogram of mean gene expression (T2D)",
    x = "Mean gene expression",
    y = "Number of genes")

```

Control (none-diabetic):

```{r}
ggplot() +
  geom_histogram(aes(x = gene_means_none_T2D),
                 bins = 50,
                 fill = "blue",
                 color = "black") +
  theme_minimal() +
  labs(title = "Histogram of mean gene expression (T2D)",
    x = "Mean gene expression",
    y = "Number of genes")

```

## Conclusion

Both data sets contain 14650 different genes but differ in sample size as there are 9 T2D samples and 54 control samples.

Generally, the distribution of the mean and median gene expression is similar between both data sets with some genes with a higher expression causing a slightly right-skewed distribution.

Further statistical analyses will be performed combined with a gene selection to determine whether the genes differ systematically between the groups.
